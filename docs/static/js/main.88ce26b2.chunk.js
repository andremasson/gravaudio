(this.webpackJsonpgravador=this.webpackJsonpgravador||[]).push([[0],{20:function(e,t,n){e.exports=n(34)},25:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n.n(c),i=(n(25),n(2)),u=n(4),l=n(1),s=n.n(l),d=n(5),m=function(e){return function(){var t=Object(d.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"UPDATE_QUERY",payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},f=Object(u.b)((function(e){return{query:e.query}}),{updateQuery:m})((function(e){var t=e.query,n=e.updateQuery,c=Object(a.useState)(""),o=Object(i.a)(c,2),u=o[0],l=o[1];return r.a.createElement("header",null,r.a.createElement("div",{className:"title"},r.a.createElement("h3",null,"Gravaudio")," ")," ",r.a.createElement("div",{className:"search-bar"},r.a.createElement("input",{type:"text",placeholder:"Buscar...",value:t,onChange:function(e){return n(e.target.value)}}))," ",r.a.createElement("div",{className:"action-bar"},r.a.createElement("div",{className:"icon-button primary",onClick:function(){return l("show")}},r.a.createElement("i",{className:"material-icons primary"}," account_circle ")," ")," ",r.a.createElement("div",{className:"icon-button danger",onClick:function(){return l("show")}},r.a.createElement("i",{className:"material-icons"}," settings ")," ")," ")," ",r.a.createElement("span",{className:"tooltip ".concat(u),onClick:function(){return l("")}},"Em breve..."))})),p=n(3),v=n(12),E=n.n(v),b=(n(33),function(e){var t=e.message,n=e.positiveAction,c=e.cancelAction,o=Object(a.useState)("overlay-visible"),u=Object(i.a)(o,2),l=u[0],s=u[1],d=function(){s("overlay-invisible"),c&&c()};return r.a.createElement("div",{className:"".concat(l),onClick:function(){return c()}},r.a.createElement("div",{className:"card dialog"},r.a.createElement("div",{className:"message"},t),r.a.createElement("div",{className:"actions"},n?r.a.createElement(a.Fragment,null,r.a.createElement("button",{className:"danger",onClick:function(){return n()}},"Sim"),r.a.createElement("button",{className:"secondary",onClick:function(){return d()}},"N\xe3o")):r.a.createElement("button",{className:"primary",onClick:function(){return d()}},"Voltar"))))});window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange;var g;window.indexedDB||console.log("Browser does not support IndexedDB");var y=window.indexedDB.open("audioDB",1),O=function(e){var t=g.transaction("audioStore","readwrite");t.oncomplete=function(e){},t.objectStore("audioStore").add(e).onsuccess=function(e){}},w=function(e,t){if(void 0!==e&&void 0!==g){var n=g.transaction("audioStore").objectStore("audioStore").get(e);n.onsuccess=function(e){t(n.result)}}};y.onupgradeneeded=function(e){e.target.result.createObjectStore("audioStore",{keyPath:"audio_id"}).createIndex("audio_id","audio_id",{unique:!0})},y.onerror=function(e){console.log("Error creating IndexdDB database")},y.onsuccess=function(e){(g=e.target.result).onerror=function(e){}};var S={StartRecording:null,StopRecording:null,GetDataURL:null,Play:null,Stop:null,RemoveRecord:null,Download:null},j="audio/webm;codecs=opus",h=null,R=null,N=null;S.StartRecording=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){var a=[],r=null;(h=new MediaRecorder(n,{mimeType:j})).onstop=function(){var t=Object(d.a)(s.a.mark((function t(n){var c,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=new Blob(a,{type:j}),c=new File([r],{type:j}),(o=new FileReader).onload=function(t){O({audio_id:e,audio_file:t.target.result})},o.readAsArrayBuffer(c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h.ondataavailable=function(e){a.push(e.data)},h.start(),null!==t&&t()}))},S.StopRecording=function(){null!==h&&h.stop()},S.GetDataURL=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;w(e,(function(e){if(void 0!==e){var n=new File([e.audio_file],{type:j}),a=new FileReader;a.onload=function(e){null!==t&&t(e.target.result)},a.readAsDataURL(n)}}))},S.Play=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==R&&S.Stop(),null!==N&&clearInterval(N),w(e,(function(e){var n=new File([e.audio_file],{type:j}),a=new FileReader;a.onload=function(e){R=document.createElement("audio");var n=document.createElement("source");n.src=e.target.result,n.type=j,R.appendChild(n),document.body.appendChild(R),R.play(),N=setInterval((function(){R&&R.ended&&(null!==t&&t(),R=null,clearInterval(N))}),100)},a.readAsDataURL(n)}))},S.Stop=function(){null!==R&&(R.pause(),R.load(),R=null),null!==N&&clearInterval(N)},S.RemoveRecord=function(e){localStorage.removeItem(e),function(e){g.transaction("audioStore","readwrite").objectStore("audioStore").delete(e)}(e)},S.Download=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio",n=t+".webm";null!==R&&S.Stop(),w(e,(function(e){var t=new Blob([e.audio_file],{type:j}),a=URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=a,r.download=n,document.body.appendChild(r),r.click(),URL.revokeObjectURL(a)}))};var D=S,A=function(){return function(){var e=Object(d.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"STOP_AUDIO"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=Object(u.b)(null,{deleteRecord:function(e){return function(){var t=Object(d.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"DELETE_RECORD",payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},saveRecord:function(e){return function(){var t=Object(d.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SAVE_RECORD",payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},playAudio:function(e,t){return function(){var n=Object(d.a)(s.a.mark((function n(a){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"PLAY_AUDIO",payload:{idAudio:e,name:t}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},stopAudio:A})((function(e){var t=e.record,n=e.deleteRecord,c=e.saveRecord,o=e.playAudio,u=(e.stopAudio,Object(a.useState)(!1)),l=Object(i.a)(u,2),s=l[0],d=l[1],m=Object(a.useState)(t.name),f=Object(i.a)(m,2),v=f[0],g=f[1],y=Object(a.useState)(!1),O=Object(i.a)(y,2),w=O[0],S=O[1],j=Object(a.useState)(null),h=Object(i.a)(j,2),R=h[0],N=h[1];Object(a.useEffect)((function(){D.GetDataURL(t.id,(function(e){N(e)}))}),[t]);var A=function(e){e.preventDefault(),S(!1),c(Object(p.a)({},t,{name:v}))};return r.a.createElement("div",{className:"record-element card"},s?r.a.createElement(b,{message:'Excluir permanentemente "'.concat(t.name.toUpperCase(),'"?'),positiveAction:function(){return n(t.id),void D.RemoveRecord(t.id)},cancelAction:function(){return d(!1)}}):"",r.a.createElement("div",{className:"card-head"},w?r.a.createElement("form",{onSubmit:function(e){return A(e)}},r.a.createElement("input",{autoFocus:!0,className:"cardEdit",type:"text",value:v,onChange:function(e){return g(e.target.value)},onBlur:function(e){return A(e)},maxLength:20})):r.a.createElement("div",{onClick:function(){return S(!0)}},r.a.createElement("span",null,t.name)," "),void 0!==R&&null!==R&&r.a.createElement("audio",{id:"HTMLMediaElementPlayer_".concat(t.id)},r.a.createElement("source",{src:R,type:"audio/webm"}))),r.a.createElement("div",{className:"card-datetime"},E()(t.timestamp).format("L - LT")),r.a.createElement("div",{className:"card-length"},t.recLength),r.a.createElement("div",{className:"actions"},r.a.createElement("div",{className:"icon-button",onClick:function(){o(t.id,v)}},r.a.createElement("i",{className:"material-icons"},"play_arrow")),r.a.createElement("div",{className:"icon-button",onClick:function(){D.Download(t.id,v)}},r.a.createElement("i",{className:"material-icons"},"get_app")),r.a.createElement("div",{className:"icon-button",onClick:function(){d(!0)}},r.a.createElement("i",{className:"material-icons"},"delete"))))})),k=function(){return r.a.createElement("div",null,r.a.createElement("h4",null," Carregando... ")," ")},_=Object(u.b)((function(e){var t=e.record;return{record:void 0===t.query||""===t.query?t:Object(p.a)({},t,{records:t.records.filter((function(e){return e.name.toUpperCase().indexOf(t.query.toUpperCase())>=0}))})}}))((function(e){var t=e.record,n=t.records;return t.loading?r.a.createElement(k,null):r.a.createElement("div",{className:"records-list"},r.a.createElement("div",{id:"audio"}),n&&n.length>0&&n.map((function(e){return r.a.createElement(C,{key:e.id,record:{name:e.name,timestamp:e.timestamp,recLength:e.recLength,id:e.id}})})))})),I=n(10),x=n(36),U=function(e){var t=e.addRecord,n=e.cancelAction,c=Object(a.useState)(null),o=Object(i.a)(c,2),u=o[0],l=o[1],s=Object(a.useState)(0),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Object(a.useState)(!1),v=Object(i.a)(p,2),E=v[0],b=v[1],g=Object(a.useState)({minutes:0,seconds:0,milliseconds:0}),y=Object(i.a)(g,2),O=y[0],w=y[1];Object(a.useEffect)((function(){if(null===u){var e=Object(x.a)();l(e),D.StartRecording(e,(function(){b(!0)}))}var t=setInterval((function(){if(E){f((function(e){return e+100}));var e=new Date(m);w({minutes:e.getMinutes(),seconds:e.getSeconds(),milliseconds:e.getMilliseconds()})}}),100);return function(){return clearInterval(t)}}),[u,m,E,l]);var S=function(){!function(){var e={id:u,name:"Novo rec "+(new Date).getSeconds().toString(),timestamp:0,recLength:"".concat(O.minutes,":").concat(O.seconds,".").concat(O.milliseconds/100)};D.StopRecording(),t(e)}(),n()};return r.a.createElement("div",{className:"overlay-visible"},r.a.createElement("div",{className:"card dialog"},r.a.createElement("div",{className:"title"},"Gravando..."),r.a.createElement("div",{className:"message"},O.minutes,":",O.seconds,".",O.milliseconds/100),r.a.createElement("div",{className:"actions"},r.a.createElement("div",{className:"icon-button",onClick:function(){return S()}},r.a.createElement("i",{className:"material-icons"},"stop")))))};U.prototype={addRecord:I.PropTypes.func.isRequired,cancelAction:I.PropTypes.func.isRequired};var L=Object(u.b)(null,{addRecord:function(e){return function(){var t=Object(d.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.timestamp=Date.now(),n({type:"ADD_RECORD",payload:e});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})(U),P=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1];return r.a.createElement(a.Fragment,null,n?r.a.createElement(L,{cancelAction:function(){c(!1)}}):r.a.createElement("div",{className:"fab",onClick:function(){return c(!0)}},r.a.createElement("div",{className:"icon-button"},r.a.createElement("i",{className:"material-icons"}," mic ")," ")," "))},B=n(6),T=n(17),q=n(18),M=n(19),F={records:[],loading:!0,error:{},query:"",lastRecordingIndex:0},G={isPlaying:!1,error:{},idAudio:"",name:""},J={menuStatus:"close"},Q=Object(B.combineReducers)({record:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"GET_RECORDS":return Object(p.a)({},e,{loading:!1});case"DELETE_RECORD":return Object(p.a)({},e,{records:e.records.filter((function(e){return e.id!==a})),loading:!1});case"ADD_RECORD":return Object(p.a)({},e,{records:[a].concat(Object(M.a)(e.records)),loading:!1});case"SAVE_RECORD":return Object(p.a)({},e,{records:e.records.map((function(e){return e.id===a.id?Object(p.a)({},e,{name:a.name}):e}))});case"UPDATE_QUERY":return Object(p.a)({},e,{query:a});default:return e}},audio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"PLAY_AUDIO":return Object(p.a)({},e,{isPlaying:!0,idAudio:a.idAudio,name:a.name});case"STOP_AUDIO":return{isPlaying:!1};default:return e}},config:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0,n=t.type;switch(n){case"OPEN_MENU":return Object(p.a)({},e,{menuStatus:"open"});case"CLOSE_MENU":return Object(p.a)({},e,{menuStatus:"close"});default:return e}}}),Y=[q.a],K=localStorage.getItem("reduxState")?JSON.parse(localStorage.getItem("reduxState")):{},V=Object(B.createStore)(Q,K,Object(T.composeWithDevTools)(B.applyMiddleware.apply(void 0,Y)));V.subscribe((function(){localStorage.setItem("reduxState",JSON.stringify(V.getState()))}));var H=V,W=Object(u.b)((function(e){return{audio:e.audio}}),{stopAudio:A})((function(e){var t=e.audio,n=e.stopAudio,c=Object(a.useState)(D),o=Object(i.a)(c,1)[0],u=t.isPlaying,l=t.idAudio;Object(a.useEffect)((function(){u?o.Play(l,(function(){n()})):o.Stop()}),[u,l,n,o]);return r.a.createElement("div",{className:"card player ".concat(u?"show":"close")},r.a.createElement("div",null,u?"Playing...":"Stopped"),r.a.createElement("div",null,t.name),r.a.createElement("div",{className:"icon-button",onClick:function(){n()}},r.a.createElement("i",{className:"material-icons"},"stop")))})),z=function(){return Object(a.useEffect)((function(){H.dispatch(A()),H.dispatch(function(){var e=Object(d.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"GET_RECORDS"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),""===localStorage.getItem("records")&&(console.log("config"),localStorage.setItem("records",JSON.stringify([]))),H.dispatch(m(""))}),[]),r.a.createElement(u.a,{store:H},r.a.createElement(f,null),r.a.createElement("main",null,r.a.createElement(_,{recordings:[]}),r.a.createElement(W,null),r.a.createElement(P,null)))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(z,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.88ce26b2.chunk.js.map